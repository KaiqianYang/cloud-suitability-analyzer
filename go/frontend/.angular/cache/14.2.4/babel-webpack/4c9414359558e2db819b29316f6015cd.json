{"ast":null,"code":"import { pushErrorNotification } from '../../../utils/notificationutil';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"../../../services/rundata.service\";\nimport * as i3 from \"ngx-toastr\";\nimport * as i4 from \"@angular/common\";\nimport * as i5 from \"@angular/forms\";\nimport * as i6 from \"@clr/angular\";\nimport * as i7 from \"../../common/excel-export/excel-export.component\";\nimport * as i8 from \"../../../pipes/search-filter.pipe\";\n\nfunction ApiByAppComponent_clr_dg_column_14_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"clr-dg-column\", 14);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const gridColumn_r3 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\"\", gridColumn_r3.toUpperCase(), \" \");\n  }\n}\n\nconst _c0 = function (a0) {\n  return {\n    first: a0\n  };\n};\n\nfunction ApiByAppComponent_clr_dg_row_17_clr_dg_cell_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"clr-dg-cell\", 16);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const gridDataCell_r6 = ctx.$implicit;\n    const first_r7 = ctx.first;\n    i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction1(2, _c0, first_r7));\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(gridDataCell_r6);\n  }\n}\n\nfunction ApiByAppComponent_clr_dg_row_17_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"clr-dg-row\");\n    i0.ɵɵtemplate(1, ApiByAppComponent_clr_dg_row_17_clr_dg_cell_1_Template, 2, 4, \"clr-dg-cell\", 15);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const gridDataRow_r4 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", gridDataRow_r4);\n  }\n}\n\nconst _c1 = function () {\n  return [25, 50, 100];\n};\n\nexport let ApiByAppComponent = /*#__PURE__*/(() => {\n  class ApiByAppComponent {\n    constructor(router, route, rundataService, toastr) {\n      this.router = router;\n      this.route = route;\n      this.rundataService = rundataService;\n      this.toastr = toastr;\n      this.searchCrit = '';\n      this.gridData = [];\n      this.gridColumns = [];\n      this.appNameFilter = new AppNameFilter();\n    }\n\n    ngOnInit() {\n      this.route.paramMap.subscribe(params => {\n        this.resetPage();\n        const runId = Number(params.get('id'));\n        this.fetchApiByApps(runId);\n      });\n    }\n\n    resetPage() {\n      this.gridData = [];\n      this.gridColumns = [];\n    }\n\n    fetchApiByApps(runId) {\n      this.rundataService.getApiByAppUsage(runId).subscribe(appApiUsageReturned => {\n        appApiUsageReturned.cols.forEach(col => {\n          /* istanbul ignore else */\n          if (col !== 'App') {\n            this.gridColumns.push(col);\n          }\n        });\n        /* istanbul ignore else */\n\n        if (appApiUsageReturned.cols && appApiUsageReturned.data) {\n          appApiUsageReturned.data.forEach(datum => {\n            const innerArr = [];\n            innerArr.push(datum.application);\n            appApiUsageReturned.cols.forEach(col => {\n              let apiusage;\n              apiusage = datum.apiusage.find(indApiUsage => indApiUsage.api.toLowerCase() === col.toLowerCase());\n              /* istanbul ignore else */\n\n              if (apiusage) {\n                innerArr.push(apiusage.usageCount);\n              }\n            });\n            this.gridData.push(innerArr);\n          });\n        }\n      }, error => {\n        pushErrorNotification(error, this.toastr);\n      });\n    }\n\n  }\n\n  ApiByAppComponent.ɵfac = function ApiByAppComponent_Factory(t) {\n    return new (t || ApiByAppComponent)(i0.ɵɵdirectiveInject(i1.Router), i0.ɵɵdirectiveInject(i1.ActivatedRoute), i0.ɵɵdirectiveInject(i2.RundataService), i0.ɵɵdirectiveInject(i3.ToastrService));\n  };\n\n  ApiByAppComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: ApiByAppComponent,\n    selectors: [[\"apibyapp\"]],\n    decls: 25,\n    vars: 18,\n    consts: [[1, \"run-data-grid\"], [1, \"action-bar\"], [1, \"action-bar-item-left\"], [3, \"data\", \"file_name\"], [1, \"action-bar-item-right\"], [\"control-width\", \"shrink\"], [\"type\", \"search\", 3, \"ngModel\", \"ngModelChange\"], [1, \"first\", 3, \"clrDgField\", \"clrDgColType\"], [3, \"clrDgStringFilter\"], [\"class\", \"dg-cell\", 4, \"ngFor\", \"ngForOf\"], [4, \"clrDgItems\", \"clrDgItemsOf\"], [3, \"clrDgPageSize\"], [\"pagination\", \"\"], [3, \"clrPageSizeOptions\"], [1, \"dg-cell\"], [\"class\", \"dg-cell\", 3, \"ngClass\", 4, \"ngFor\", \"ngForOf\"], [1, \"dg-cell\", 3, \"ngClass\"]],\n    template: function ApiByAppComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\")(1, \"clr-datagrid\", 0)(2, \"clr-dg-action-bar\")(3, \"div\", 1)(4, \"div\", 2);\n        i0.ɵɵelement(5, \"app-excel-export\", 3);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(6, \"div\", 4)(7, \"cds-search\", 5)(8, \"label\");\n        i0.ɵɵtext(9, \"Search\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(10, \"input\", 6);\n        i0.ɵɵlistener(\"ngModelChange\", function ApiByAppComponent_Template_input_ngModelChange_10_listener($event) {\n          return ctx.searchCrit = $event;\n        });\n        i0.ɵɵelementEnd()()()()();\n        i0.ɵɵelementStart(11, \"clr-dg-column\", 7);\n        i0.ɵɵtext(12, \"App \");\n        i0.ɵɵelement(13, \"clr-dg-string-filter\", 8);\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(14, ApiByAppComponent_clr_dg_column_14_Template, 2, 1, \"clr-dg-column\", 9);\n        i0.ɵɵelementStart(15, \"clr-dg-placeholder\");\n        i0.ɵɵtext(16, \"No API by app information found\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(17, ApiByAppComponent_clr_dg_row_17_Template, 2, 1, \"clr-dg-row\", 10);\n        i0.ɵɵpipe(18, \"searchFilter\");\n        i0.ɵɵelementStart(19, \"clr-dg-footer\")(20, \"clr-dg-pagination\", 11, 12)(22, \"clr-dg-page-size\", 13);\n        i0.ɵɵtext(23, \"API by App (Summary) per page\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtext(24);\n        i0.ɵɵelementEnd()()()();\n      }\n\n      if (rf & 2) {\n        const _r2 = i0.ɵɵreference(21);\n\n        i0.ɵɵadvance(5);\n        i0.ɵɵproperty(\"data\", ctx.gridData)(\"file_name\", \"api-by-app.csv\");\n        i0.ɵɵadvance(5);\n        i0.ɵɵproperty(\"ngModel\", ctx.searchCrit);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"clrDgField\", \"App\")(\"clrDgColType\", \"string\");\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"clrDgStringFilter\", ctx.appNameFilter);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngForOf\", ctx.gridColumns);\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"clrDgItemsOf\", i0.ɵɵpipeBind3(18, 13, ctx.gridData, \"name\", ctx.searchCrit));\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"clrDgPageSize\", 25);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"clrPageSizeOptions\", i0.ɵɵpureFunction0(17, _c1));\n        i0.ɵɵadvance(2);\n        i0.ɵɵtextInterpolate3(\" \", _r2.firstItem + 1, \" - \", _r2.lastItem + 1, \" of \", _r2.totalItems, \" API by App summary (filtered) showing for portfolio... \");\n      }\n    },\n    dependencies: [i4.NgClass, i4.NgForOf, i5.DefaultValueAccessor, i5.NgControlStatus, i6.ClrDatagrid, i6.ClrDatagridActionBar, i6.ClrDatagridColumn, i6.ClrDatagridItems, i6.ClrDatagridRow, i6.ClrDatagridCell, i6.ClrDatagridFooter, i6.ClrDatagridPagination, i6.ClrDatagridPageSize, i6.ClrDatagridPlaceholder, i6.ÇlrDatagridMainRenderer, i6.ÇlrDatagridHeaderRenderer, i6.ÇlrDatagridRowRenderer, i6.ÇlrDatagridCellRenderer, i6.ÇlrDatagridWillyWonka, i6.ÇlrActionableOompaLoompa, i6.ÇlrExpandableOompaLoompa, i6.DatagridStringFilter, i6.ClrLabel, i5.NgModel, i7.ExcelExportComponent, i8.SearchFilterPipe],\n    styles: [\".dg-cell[_ngcontent-%COMP%]{text-align:center;width:170px}.first[_ngcontent-%COMP%]{width:170px;text-align:left}\", \".run-data-tab[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:flex-start;padding:14px 0 0;height:36px;left:25px}.run-data-tabs[_ngcontent-%COMP%]{padding-top:10px}.run-data-tab-grid-divider[_ngcontent-%COMP%]{height:1px;left:0%;right:0%;top:448px;background:#CCCCCC}.run-data-grid[_ngcontent-%COMP%]{display:flex}.run-data-grid-export[_ngcontent-%COMP%]{width:74px;height:36px;left:25px;top:352px}.action-bar[_ngcontent-%COMP%]{display:flex}.action-bar-item-left[_ngcontent-%COMP%]{width:80%}.action-bar-item-right[_ngcontent-%COMP%]{width:20%}\"]\n  });\n  return ApiByAppComponent;\n})();\n\nclass AppNameFilter {\n  accepts(apiByAppRow, search) {\n    // @ts-ignore\n    return apiByAppRow[0].toLowerCase().indexOf(search) >= 0;\n  }\n\n}","map":null,"metadata":{},"sourceType":"module"}